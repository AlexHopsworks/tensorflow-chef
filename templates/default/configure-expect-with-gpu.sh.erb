#!/usr/bin/expect

spawn "./configure"
expect '/usr/bin/python]: '
send "\r"
# Please specify optimization flags to use during compilation when bazel option "--config=opt" is specified [Default is -march=native]
expect '] '
send "\r"
# Do you wish to use jemalloc as the malloc implementation? [Y/n] Y
expect 'n] '
send "y\r"
# Do you wish to build TensorFlow with Google Cloud Platform support? [y/N] 
expect "Do you wish to build TensorFlow with Google Cloud Platform*"
send "\r"
# Do you wish to build TensorFlow with Hadoop File System support? [y/N] y
expect "Do you wish to build TensorFlow with Hadoop File System*"
send "y\r"
# Do you wish to build TensorFlow with the XLA just-in-time compiler (experimental)? [y/N] N
expect "Do you wish to build TensorFlow with the XLA*"
send "N\r"
# Found possible Python library paths:
#  /usr/local/lib/python2.7/dist-packages
#  /usr/lib/python2.7/dist-packages
# Please input the desired Python library path to use.  Default is [/usr/local/lib/python2.7/dist-packages]
expect "]*"
send "\r"
# Do you wish to build TensorFlow with OpenCL support? [y/N] n
expect "]*"
send "N\r"
#  Do you wish to build TensorFlow with CUDA support? [y/N]
expect "Do you wish to build TensorFlow with GPU support?*"
send "Y\r"
expect 'Please specify which gcc should be used by nvcc as the host compiler. [Default is /usr/bin/gcc]: '
send "\r"
expect 'Please specify the Cuda SDK version you want to use, e.g. 7.0. [Leave empty to use system default]: '
send "#{node.cuda.major_version}\r"
expect 'Please specify the location where CUDA #{node.cuda.major_version} toolkit is installed. Refer to README.md for more details. [Default is /usr/local/cuda]: '
send "/usr\r"
expect 'Please specify the Cudnn version you want to use. [Leave empty to use system default]: '
send "#{node.cudnn.major_version}\r"
expect 'Refer to README.md for more details. [Default is /usr/local/cuda]: '
send "\r"
expect '[Default is: "3.5,5.2"]: '
send "6.1\r"
expect eof
